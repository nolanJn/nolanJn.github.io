---
layout:     post
title:      深入理解java虚拟机
subtitle:   JVM高级特性与最佳实践
date:       2017-09-15
author:     Nolan
header-img: img/post-bg-ios10.jpg
catalog: true
tags:
    - JVM
    - java
    - java虚拟机
---

## 一、java内存区域与内存溢出异常 ##

### 1.jvm虚拟机运行时数据区 ###

![jvm虚拟机运行时数据区](/img/JVM_neicunhuafeng.png)

**1.1 程序计数器**

**1.2 java虚拟机栈**

**1.3 本地方法栈**

**1.4 java堆**

**1.5 方法区**

**1.6 运行时常量区**

**1.7 直接内存**

### 2.HotSpot虚拟机对象 ###

**2.1 对象的创建**

	普通对象的创建（不包括数组和Class对象等）——

**2.2 对象的内存布局**

**2.3 对象的访问定位**

 目前主流的访问方式有使用句柄和直接指针两种。
 
 a：如果使用句柄访问的话，那么java堆中将会划分出一块内存来作为句柄池，reference       中存储的就是对象的句柄地址，而句柄中包含了对象示例数据与类型数据各自的具体地址信息。

![](/img/JVM_dxfwfs1.png)

 b：如果使用直接指针访问，那么java堆对象的布局中就必须考虑如何放置访问类型数据的相关信息，二reference中存储的直接就是对象的地址。

![](/img/JVM_dxfwfs2.png)

 这两种对象的访问方式各有优势，使用句柄来访问的最大好处就是reference中存储的是稳定的句柄地址，在对象被移动（垃圾收集是移动对象是非常普遍的行为）时只会改变句柄中的实例数据指针，二reference本身不需要修改。
 使用直接指针访问方式的最大好处就是速度更快，它节省了一次指针定位的时间开销，由于对象的访问在java中非常频繁，因此这类开销积少成多后也是一项非常客观的执行成本。
  
	
	